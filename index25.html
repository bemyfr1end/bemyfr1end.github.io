
<!DOCTYPE HTML>
<html>
<head>
<style>
.canvasjs-chart-credit{
display: none !important;
}
canvas {
            border: 1px solid black;
        }
* {
box-sizing: border-box;
}

/* Create two equal columns that floats next to each other */
.column {
float: left;
width: 50%;
padding: 10px;
 /* Should be removed. Only for demonstration */
}

/* Clear floats after the columns */
.row:after {
content: "";
display: table;
clear: both;
}
</style>
<script type="text/javascript">
window.onload = function () {
var chart = new CanvasJS.Chart("chartContainer",
{
title: {
text: "Video"
},
axisX: {		       
lineDashType: "dot",
lineThickness: 2
},
axisY: {
gridThickness: 0
},
data: [
{
type: "line",
dataPoints: [
{            
y: -533.9428529804497,
x: 344.04369949943293,
"score": 0.5974737405776978,
indexLabel: "nose"
}]},
{
type: "line",
dataPoints: [

{
y: -519.6629284484276,
x: 353.1043630893736,
"score": 0.5863508582115173,
indexLabel: "left_eye"
},
{
y: -521.2078047393502,
x: 369.3384625864846,
"score": 0.7582522034645081,
indexLabel: "left_ear"
}
]
},
{
type: "line",
dataPoints: [
{
y: -523.1379844588508,
x: 330.9581947935336,
"score": 0.6939294934272766,
indexLabel: "right_eye"
},
{
y: -531.7402231824378,
x: 319.29205189831333,
"score": 0.5770164132118225,
indexLabel: "right_ear"
}
]
},
{
type: "line",
dataPoints: [
{
y: -669.8975534086187,
x: 538.9648461758387,
"score": 0.7035307288169861,
indexLabel: "left_wrist"
},
{
y: -618.4243339325817,
x: 488.4795363990285,
"score": 0.8395420908927917,
indexLabel: "left_elbow"
},
{
y: -563.5765096437527,
x: 419.088953092079,
"score": 0.8049867749214172,
indexLabel: "left_shoulder"
},
{
y: -591.2672479820579,
x: 295.2490425422431,
"score": 0.8740116357803345,
indexLabel: "right_shoulder"
},
{
y: -675.4573524823124,
x: 274.40488359569764,
"score": 0.8469448089599609,
indexLabel: "right_elbow"
},
{
y: -744.5172968449345,
x: 294.0558167031675,
"score": 0.7961530685424805,
indexLabel: "right_wrist"
}
]
},
{
type: "line",
dataPoints: [

{
y: -563.5765096437527,
x: 419.088953092079,
"score": 0.8049867749214172,
indexLabel: "left_shoulder"
},
{
y: -689.1822109132509,
x: 431.0846933955858,
"score": 0.8640961050987244,
indexLabel: "left_hip"
},
{
y: -702.9775215185546,
x: 364.84822861638423,
"score": 0.8855389952659607,
indexLabel: "right_hip"
},
{
y: -591.2672479820579,
x: 295.2490425422431,
"score": 0.8740116357803345,
indexLabel: "right_shoulder"
}
]
},{
type: "line",
dataPoints: [

{
y: -874.853959280996,
x: 444.0512174549555,
"score": 0.8049867749214172,
indexLabel: "left_ankle"
},{
y: -768.0988064115821,
x: 406.5349681135893,
"score": 0.8049867749214172,
indexLabel: "left_knee"
},
{
y: -689.1822109132509,
x: 431.0846933955858,
"score": 0.8640961050987244,
indexLabel: "left_hip"
},
{
y: -702.9775215185546,
x: 364.84822861638423,
"score": 0.8855389952659607,
indexLabel: "right_hip"
},
{
y: -817.031002425374,
x: 361.3349711616232,
"score": 0.8740116357803345,
indexLabel: "right_knee"
},
{
y: -872.9592009843852,
x: 413.87327212083926,
"score": 0.8740116357803345,
indexLabel: "right_ankle"
}
]
}
]         
});
var chart1 = new CanvasJS.Chart("chartContainer1",
{
title: {
text: "Webcam"
},
axisX: {		       
lineDashType: "dot",
lineThickness: 2
},
axisY: {
gridThickness: 0
},
data: [
{
type: "line",
dataPoints: [
{            
y: -0.5195906758308411,
x: -0.43893003463745117,
"score": 0.5974737405776978,
indexLabel: "nose"
}]},
{
type: "line",
dataPoints: [

{
y: -0.41236191987991333,
x: -0.37934744358062744,
"score": 0.5863508582115173,
indexLabel: "left_eye"
},
{
y: -0.3935645818710327,
x: -0.34576040506362915,
"score": 0.7582522034645081,
indexLabel: "left_ear"
}
]
},
{
type: "line",
dataPoints: [
{
x: -0.5483154654502869,
y: -0.380584716796875,
"score": 0.6939294934272766,
indexLabel: "right_eye"
},
{
x: -0.5018344521522522,
y: -0.40469086170196533,
"score": 0.5770164132118225,
indexLabel: "right_ear"
}
]
},
{
type: "line",
dataPoints: [
{
x: -0.09488728642463684,
y: -1.4059630632400513,
"score": 0.7035307288169861,
indexLabel: "left_wrist"
},
{
x: -0.13501736521720886,
y: -1.0009191036224365,
"score": 0.8395420908927917,
indexLabel: "left_elbow"
},
{
x: -0.23558855056762695,
y: -0.6093683242797852,
"score": 0.8049867749214172,
indexLabel: "left_shoulder"
},
{
x: -0.6955552697181702,
y: -0.5792189836502075,
"score": 0.8740116357803345,
indexLabel: "right_shoulder"
},
{
x: -0.8170663118362427,
y: -0.9429570436477661,
"score": 0.8469448089599609,
indexLabel: "right_elbow"
},
{
x: -0.8664507865905762,
y: -1.3756768703460693,
"score": 0.7961530685424805,
indexLabel: "right_wrist"
}
]
},
{
type: "line",
dataPoints: [

{
x: -0.23558855056762695,
y: -0.6093683242797852,
"score": 0.8049867749214172,
indexLabel: "left_shoulder"
},
{
x: -0.3413872718811035,
y: -1.3473975658416748,
"score": 0.8640961050987244,
indexLabel: "left_hip"
},
{
x: -0.6391734480857849,
y: -1.3244295120239258,
"score": 0.8855389952659607,
indexLabel: "right_hip"
},
{
x: -0.6955552697181702,
y: -0.5792189836502075,
"score": 0.8740116357803345,
indexLabel: "right_shoulder"
}
]
},{
type: "line",
dataPoints: [

{
x: -0.37657442688941956,
y: -2.52108097076416,
"score": 0.8049867749214172,
indexLabel: "left_ankle"
},{
x: -0.352548748254776,
y: -1.961724042892456,
"score": 0.8049867749214172,
indexLabel: "left_knee"
},
{
x: -0.3413872718811035,
y: -1.3473975658416748,
"score": 0.8640961050987244,
indexLabel: "left_hip"
},
{
x: -0.6391734480857849,
y: -1.3244295120239258,
"score": 0.8855389952659607,
indexLabel: "right_hip"
},
{
x: -0.635826051235199,
y: -1.9670422077178955,
"score": 0.8740116357803345,
indexLabel: "right_knee"
},
{
x: -0.6406723260879517,
y: -2.4928407669067383,
"score": 0.8740116357803345,
indexLabel: "right_ankle"
}
]
}
]         
});
chart.render();
chart1.render();
}
</script>
<script type="text/javascript" src="https://cdn.canvasjs.com/canvasjs.min.js"></script>
</head>
<body>
<div class="row">
<div class="column" style="background-color:#aaa;">
<div id="chartContainer" style="height: 600px; margin: 0px auto;"></div>
</div>
<div class="column" style="background-color:#bbb;">
<div id="chartContainer1" style="height: 600px; margin: 0px auto;"></div>
</div>
</div>
<canvas id="main_canvas" width="500" height="500">
    Your browser does not support the canvas element.
</canvas>
<button onclick="start_line_cont();">Find Angle</button>
<div id="body_joints">
<div id="nose">nose</div>
<div id="mouth">mouth</div>
<div id="lefteye">left_eye</div>
<div id="lefteye">right_eye</div>
<div id="mouth">right_ear</div>
<div id="nose">left_ear</div>
<div id="mouth">mputh</div>
<div id="lefteye">left_shoulder</div>
<div id="lefteye">right_shoulder</div>
<div id="mouth"></div>

</div>

<script>
    // create canvas element and append it to document body
    var canvas = document.getElementById('main_canvas');
    // Get canvas 2D context
    var ctx = canvas.getContext('2d');

    // Fill background of Canvas with White
    ctx.fillStyle = "White";
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    ctx.fillStyle = "Black";

    // Set initial variables
    let points = {};
    let p1_s = 0;
    let point_num = 0;
    let point_1_x = 0;
    let point_1_y = 0;
    let line_draw_cont = false;

    // Store last known position of mouse
    var pos = {
        x: 0,
        y: 0
    };

    // Find the angle created between two lines
    const find_two_lines_angle = (p1_s) => {
        // Find vector components
        var dAx = points[(p1_s + 1)][0] - points[p1_s][0];
        var dAy = points[(p1_s + 1)][1] - points[p1_s][1];
        var dBx = points[(p1_s + 2)][0] - points[(p1_s + 1)][0];
        var dBy = points[(p1_s + 2)][1] - points[(p1_s + 1)][1];
        var angle = Math.atan2(dAx * dBy - dAy * dBx, dAx * dBx + dAy * dBy);
        if (angle < 0) {
            angle = angle * -1;
        }
        var degree_angle = 180 - (angle * (180 / Math.PI));

        // Log result
        console.log('Angle between the last two lines is: ' + degree_angle);
    }

    // Find the angle of the last drawn line
    const find_line_angle = () => {
        let dx = pos.x - point_1_x;
        let dy = pos.y - point_1_y;
        let ang = (Math.atan2(dy, dx) * 180 / Math.PI) * -1;

        // Log result
        console.log('Angle of last line is: ' + ang);
    }

    // Set listening events
    document.addEventListener('mousedown', setPosition);
    document.addEventListener('mouseenter', setPosition);
    document.addEventListener('mousedown', draw_cont_line);

    // Get new position from mouse event
    function setPosition(e) {
        pos.x = original_x = e.clientX;
        pos.y = original_y = e.clientY;
    }

    // Check to see if line drawing is active
    const start_line_cont = (area) => {
        if (line_draw_cont == false) {
            line_draw_cont = true;
        } else line_draw_cont = false;
    }

    // Function to draw the line at the Canvas
    function draw_cont_line(e) {
        // Check for mouse left button must be pressed
        if (e.buttons !== 1) return;
        // Check for drawing to be active
        if (line_draw_cont !== true) return;

        console.log(line_draw_cont);

        ctx.beginPath(); // begin

        ctx.lineWidth = 3;
        ctx.lineCap = 'round';
        ctx.strokeStyle = '#c0392b';

        if (point_num == 0) {
            setPosition(e);
            points[point_num] = [pos.x, pos.y];
            str = JSON.stringify(points);
            //console.log(str);

            point_1_x = pos.x;
            point_1_y = pos.y;
            point_num++;

        } else {
            // Get mouse position
            setPosition(e);
            // Set point into array
            points[point_num] = [pos.x, pos.y];
            // Set From Spot
            ctx.moveTo(point_1_x, point_1_y);
            // Set To Spot
            ctx.lineTo(pos.x, pos.y);
            // Draw Line
            ctx.stroke();
            // Find angle of drawn line
            find_line_angle();

            // Set up for next point
            // Set latest mouse location (initial point) for next line
            point_1_x = pos.x;
            point_1_y = pos.y;

            // Check to see if two lines have been drawn, if yes then stop drawing and find angle created by the two past lines
            if (point_num == 2) {
                console.log('End line');
                line_draw_cont = false;
                p1_s = point_num = 0;
                // Find angle
                find_two_lines_angle(p1_s);
            } else {
                // Increase point number by 1
                point_num++;
            }

        }
    }
</script>
</body>
</html>